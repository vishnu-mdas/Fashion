<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:35 GMT -->
<head>
    <meta charset="utf-8">
    <title>Fashion</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/evara-backend/assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="/evara-backend/assets/css/main.css" rel="stylesheet" type="text/css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="index.html" class="brand-wrap">
                <img src="/evara-backend/assets/imgs/theme/logo.svg" class="logo" alt="Evara Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item active">
                    <a class="menu-link" href="/admin"> <i class="icon material-icons md-home"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-products-list.html"> <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Products</span>
                    </a>
                    <div class="submenu">
                        <a href="/admin/product_list">Product List</a>
                        <a href="/admin/product_add">Product Add</a>
                        <a href="/admin/category">Categories</a>
                    </div>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-Userlist.html"> <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Users</span>
                    </a>
                    <div class="submenu">
                        <a href="/admin/users">User list </a>
                       
                    </div>
                </li>
                <li class="menu-item has-submenu">
                  <a class="menu-link" href="page-addBanner.html"> <i class="icon material-icons md-shopping_bag"></i>
                      <span class="text">Banners</span>
                  </a>
                  <div class="submenu">
                      <a href="/admin/addBanner">Add Banner</a>
                      <a href="/admin/listBanners">List Banner</a>
                      
                  </div>
              </li>


              <li class="menu-item has-submenu">
                <a class="menu-link" href="page-addCoupon.html"> <i class="icon material-icons md-shopping_bag"></i>
                    <span class="text">Coupons</span>
                </a>
                <div class="submenu">
                    <a href="/admin/addCoupon">Add Coupon</a>
                    <a href="/admin/showCoupon">Coupon List</a>
                    
                </div>
            </li>


                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-sellers-cards.html"> <i class="icon material-icons md-store"></i>
                        <span class="text">Sellers</span>
                    </a>
                    <div class="submenu">
                        <a href="page-sellers-cards.html">Sellers cards</a>
                        <a href="page-sellers-list.html">Sellers list</a>
                        <a href="page-seller-detail.html">Seller profile</a>
                    </div>
                </li> -->
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-form-product-1.html"> <i class="icon material-icons md-add_box"></i>
                        <span class="text">Add product</span>
                    </a>
                    <div class="submenu">
                        <a href="page-form-product-1.html">Add product 1</a>
                        <a href="page-form-product-2.html">Add product 2</a>
                        <a href="page-form-product-3.html">Add product 3</a>
                        <a href="page-form-product-4.html">Add product 4</a>
                    </div>
                </li> -->
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-monetization_on"></i>
                        <span class="text">Orders</span>
                    </a>
                    <div class="submenu">
                        <a href="/admin/orders">Orders</a>
                        
                    </div>
                </li>
               
                <li class="menu-item">
                    <a class="menu-link" href="/admin/salesReport"> <i class="icon material-icons md-comment"></i>
                        <span class="text">Sales Report</span>
                    </a>
                </li>
                <!-- <li class="menu-item">
                    <a class="menu-link" href="page-brands.html"> <i class="icon material-icons md-stars"></i>
                        <span class="text">Brands</span> </a>
                </li> -->
               
            </ul>
            <hr>
           
            <br>
            <br>
        </nav>
    </aside>
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">
                
            </div>
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i class="material-icons md-apps"></i> </button>
                <ul class="nav">
                    
                    <!-- <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownLanguage" aria-expanded="false"><i class="material-icons md-public"></i></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLanguage">
                            <a class="dropdown-item text-brand" href="#"><img src="/evara-backend/assets/imgs/theme/flag-us.png" alt="English">English</a>
                            <a class="dropdown-item" href="#"><img src="/evara-backend/assets/imgs/theme/flag-fr.png" alt="Français">Français</a>
                            <a class="dropdown-item" href="#"><img src="/evara-backend/assets/imgs/theme/flag-jp.png" alt="Français">日本語</a>
                            <a class="dropdown-item" href="#"><img src="/evara-backend/assets/imgs/theme/flag-cn.png" alt="Français">中国人</a>
                        </div>
                    </li> -->
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount" aria-expanded="false"> <img class="img-xs rounded-circle" src="/evara-backend/assets/imgs/people/avatar2.jpg" alt="User"></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
                            <a class="dropdown-item" href="#"><i class="material-icons md-perm_identity"></i>Edit Profile</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-settings"></i>Account Settings</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-account_balance_wallet"></i>Wallet</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-receipt"></i>Billing</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-help_outline"></i>Help center</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="/admin/logout"><i class="material-icons md-exit_to_app"></i>Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
        </header>
        <section class="content-main">
            <!-- <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Dashboard </h2>
                    <p>Whole data about your business here</p>
                </div>
               
            </div> -->
        
            <div>
                <h2 class="content-title card-title">Dashboard</h2>
                <p>Whole data about your business here</p>
              </div>
              
              <div class="row">
                <div class="col-lg-3">
                  <div class="card card-body mb-4">
                    <article class="icontext">
                      <span class="icon icon-sm rounded-circle bg-primary-light"
                        ><i class="text-primary material-icons md-monetization_on"></i
                      ></span>
                      <div class="text">
                        <h6 class="mb-1 card-title">Revenue</h6>
                        <%# if(currentMonthSales) { %>
                        <!-- <span>₹ <%#=currentMonthSales.totalAmount %></span> -->
                        <%# } else { %>
                        <span>₹<span id="revenueCard"></span></span>
                        <%# } %>
                        <span class="text-sm"> On this month </span>
                      </div>
                    </article>
                  </div>
                </div>
                <div class="col-lg-3">
                  <div class="card card-body mb-4">
                    <article class="icontext">
                      <span class="icon icon-sm rounded-circle bg-success-light"
                        ><i class="text-success material-icons md-local_shipping"></i
                      ></span>
                      <div class="text">
                        <h6 class="mb-1 card-title">Orders</h6>
                        <span id="ordersCard">  </span>
                        <span class="text-sm"> Including orders in transit </span>
                      </div>
                    </article>
                  </div>
                </div>
                <div class="col-lg-3">
                  <div class="card card-body mb-4">
                    <article class="icontext">
                      <span class="icon icon-sm rounded-circle bg-warning-light"
                        ><i class="text-warning material-icons md-qr_code"></i
                      ></span>
                      <div class="text">
                        <h6 class="mb-1 card-title">Products</h6>
                        <span id="productsCard"></span>
                        <span class="text-sm"> Including Disabled Products </span>
                      </div>
                    </article>
                  </div>
                </div>
                <div class="col-lg-3">
                  <div class="card card-body mb-4">
                    <article class="icontext">
                      <span class="icon icon-sm rounded-circle bg-info-light"
                        ><i class="text-info material-icons md-group"></i
                      ></span>
                      <div class="text">
                        <h6 class="mb-1 card-title">Total Users</h6>
                        <span id="usersCard"> </span>
                        <span class="text-sm"> Including the Blocked Users </span>
                      </div>
                    </article>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-8 col-lg-12">
                  <div class="row">
                    <div class="col-12">
                      <div class="card mb-4">
                        <article class="card-body">
                          <h5 class="card-title">Sale statistics</h5>
                          <select id="chart-filter">
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                          </select>
                          <canvas id="myChart" height="120rem"></canvas>
                        </article>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="card mb-4">
                        <article class="card-body">
                          <h5 class="card-title">Order statitics</h5>
                          <select id="chart-filter2">
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                          </select>
                          <canvas id="myChart2" height="120rem"></canvas>
                        </article>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xl-4 col-lg-12">
                  <div class="card mb-4">
                    <article class="card-body">
                      <h5 class="card-title"></h5>
                       <!-- Sales on category -->
                      <canvas id="categoryChart"></canvas>
                    </article>
                  </div>
                </div>
              </div>
              
              
        
        </section> <!-- content-main end// -->
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> ©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>

    <!-- <script>
        // if ($("#myChart").length) {
        //   console.log("insidemycharttttttttttttttttttttt");
        //   const strigData = `<%#- JSON.stringify(salesByMonth) %>`;
        //   const strigYearly = `<%#- JSON.stringify(salesByYear) %>`;
        //   const salesData = JSON.parse(strigData);
        //   const yearlyData = JSON.parse(strigYearly);
        //   var ctx = document.getElementById("myChart").getContext("2d");
        //   var chart = new Chart(ctx, {
        //     type: "line",
        //     data: {
        //       labels: [
        //         "Jan",
        //         "Feb",
        //         "Mar",
        //         "Apr",
        //         "May",
        //         "Jun",
        //         "Jul",
        //         "Aug",
        //         "Sep",
        //         "Oct",
        //         "Nov",
        //         "Dec",
        //       ],
        //       datasets: [
        //         {
        //           label: "Sales",
        //           tension: 0.3,
        //           fill: true,
        //           backgroundColor: "rgba(44, 120, 220, 0.2)",
        //           borderColor: "rgba(44, 120, 220)",
        //           data: Array.from({ length: 12 }).map((_, index) => {
        //             const monthSales = salesData.find(
        //               (sale) => sale._id === index + 1
        //             );
        //             return monthSales ? monthSales.totalAmount : 0;
        //           }),
        //         },
        //       ],
        //     },
        //     options: {
        //       plugins: {
        //         legend: {
        //           labels: {
        //             usePointStyle: true,
        //           },
        //         },
        //       },
        //     },
        //   });
        //   const filterSelect = document.getElementById("chart-filter");
        //   filterSelect.addEventListener("change", () => {
        //     const filterValue = filterSelect.value;
        //     if (filterValue === "monthly") {
        //       chart.data.labels = [
        //         "Jan",
        //         "Feb",
        //         "Mar",
        //         "Apr",
        //         "May",
        //         "Jun",
        //         "Jul",
        //         "Aug",
        //         "Sep",
        //         "Oct",
        //         "Nov",
        //         "Dec",
        //       ];
        //       chart.data.datasets[0].data = Array.from({ length: 12 }).map(
        //         (_, index) => {
        //           const monthSales = salesData.find((sale) => sale._id === index + 1);
        //           return monthSales ? monthSales.totalAmount : 0;
        //         }
        //       );
        //       chart.update();
        //     } else if (filterValue === "yearly") {
        //       chart.data.labels = ["2021", "2022", "2023", "2024", "2025"];
        //       chart.data.datasets[0].data = chart.data.labels.map((label) => {
        //         const yearSales = yearlyData.find((sale) => sale._id == label);
        //         return yearSales ? yearSales.totalAmount : 0;
        //       });
        //       chart.update();
        //     }
        //   });
        // }
        if ($("#myChart2").length) {
          const strigData = `<%#- JSON.stringify(ordersByDate) %>`;
          const orderData = JSON.parse(strigData);
          var ctx = document.getElementById("myChart2").getContext("2d");
          var orderChart = new Chart(ctx, {
            type: "bar",
            data: {
              labels: [
                "Jan",
                "Feb",
                "Mar",
                "Apr",
                "May",
                "Jun",
                "Jul",
                "Aug",
                "Sep",
                "Oct",
                "Nov",
                "Dec",
              ],
              datasets: [
                {
                  label: "Orders",
                  backgroundColor: "#5897fb",
                  barThickness: 15,
                  data: Array.from({ length: 12 }).map((_, index) => {
                    const monthlyOrder = orderData.find(
                      (order) => order._id.month === index + 1
                    );
                    return monthlyOrder ? monthlyOrder.count : 0;
                  }),
                },
              ],
            },
            options: {
              plugins: {
                legend: {
                  labels: {
                    usePointStyle: true,
                  },
                },
              },
              scales: {
                y: {
                  beginAtZero: true,
                },
              },
            },
          });
          const filterSelect = document.getElementById("chart-filter2");
          filterSelect.addEventListener("change", () => {
            const filterValue = filterSelect.value;
            if (filterValue === "monthly") {
              orderChart.data.labels = [
                "Jan",
                "Feb",
                "Mar",
                "Apr",
                "May",
                "Jun",
                "Jul",
                "Aug",
                "Sep",
                "Oct",
                "Nov",
                "Dec",
              ];
              orderChart.data.datasets[0].data = Array.from({ length: 12 }).map(
                (_, index) => {
                  const monthlyOrder = orderData.find(
                    (order) => order._id.month === index + 1
                  );
                  return monthlyOrder ? monthlyOrder.count : 0;
                }
              );
              orderChart.update();
            } else if (filterValue === "yearly") {
              const ordersByYear = orderData.reduce((acc, cur) => {
                const year = cur._id.year;
                const count = cur.count;
                if (year in acc) {
                  acc[year] += count;
                } else {
                  acc[year] = count;
                }
                return acc;
              }, {});
              const years = ["2021", "2022", "2023", "2024", "2025"];
              orderChart.data.labels = years;
              orderChart.data.datasets[0].data = years.map(
                (year) => ordersByYear[year] || 0
              );
              orderChart.update();
            }
          });
        }
        if ($("#categoryChart").length) {
          const strigData = `<%#- JSON.stringify(categorySales) %>`;
          const categorySalesData = JSON.parse(strigData);
          console.log(cccccccccccccccategorySalesDataaaaaaaaaaaaaaaaaaa);
          const categories = categorySalesData.map((category) => category.name);
          console.log(categoriesssssssssssssssss);
          const categoryColors = categorySalesData.map(() => {
            const randomColor = Math.floor(Math.random() * 16777215).toString(16);
            return `#${randomColor.padStart(6, "0")}`;
          });
          const categoryCount = categorySalesData.map((category) => category.count);
          var ctx = document.getElementById("categoryChart").getContext("2d");
          var categoryChart = new Chart(ctx, {
            type: "doughnut",
            data: {
              labels: categories,
              datasets: [
                {
                  label: "Categories",
                  backgroundColor: categoryColors,
                  data: categoryCount,
                },
              ],
            },
            options: {
              plugins: {
                legend: {
                  labels: {
                    usePointStyle: true,
                  },
                },
              },
            },
          });
        }
      </script> -->

      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
      <script src="/evara-backend/assets/js/vendors/chart.js"></script>

    <script src="/evara-backend/assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/evara-backend/assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/evara-backend/assets/js/vendors/select2.min.js"></script>
    <script src="/evara-backend/assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="/evara-backend/assets/js/vendors/jquery.fullscreen.min.js"></script>
    <script src="/evara-backend/assets/js/vendors/chart.js"></script>
    <!-- Main Script -->
    <script src="/evara-backend/assets/js/main.js" type="text/javascript"></script>
    <!-- <script src="/evara-backend/assets/js/custom-chart.js" type="text/javascript"></script> -->

<script>
  function updateChart(sales,orders){
    let dailyOrders = [];
    orders.forEach(order => {
      dailyOrders.push(order.totalAmount);
    });
    if ($('#myChart').length) {
        var ctx = document.getElementById('myChart').getContext('2d');
        var chart = new Chart(ctx, {
            // The type of chart we want to create
            type: 'line',
            // The data for our dataset
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [
                    {
                        label: 'Sales',
                        tension: 0.3,
                        fill: true,
                        backgroundColor: 'rgba(44, 120, 220, 0.2)',
                        borderColor: 'rgba(44, 120, 220)',
                        data: dailyOrders
                    },
                    {
                        label: 'Orders',
                        tension: 0.3,
                        fill: true,
                        backgroundColor: 'rgba(4, 209, 130, 0.2)',
                        borderColor: 'rgb(4, 209, 130)',
                        data: [40, 20, 17, 9, 23, 35, 39, 30, 34, 25, 27, 17]
                    },
                    {
                        label: 'Products',
                        tension: 0.3,
                        fill: true,
                        backgroundColor: 'rgba(380, 200, 230, 0.2)',
                        borderColor: 'rgb(380, 200, 230)',
                        data: [30, 10, 27, 19, 33, 15, 19, 20, 24, 15, 37, 6]
                    }
                ]
            },
            options: {
                plugins: {
                legend: {
                    labels: {
                    usePointStyle: true,
                    },
                }
                }
            }
        });
    } 
  }
</script>







<!-- scripts to update the cards -->
<script>
  function updateCards(revenue,orders,products,users){
    document.getElementById('revenueCard').innerHTML = revenue;
    document.getElementById('ordersCard').innerHTML = orders;
    document.getElementById('productsCard').innerHTML = products;
    document.getElementById('usersCard').innerHTML = users;
  }
</script>
<!-- scripts to fetch sales report -->
<script>
  function update(){
    $.ajax({
      url:'/admin/updateDashboard',
      method:'POST',
      success:function(res){
        console.log(res.salesByMonth,'salesByMonth,',
                    res.salesByYear,'salesByYear,',
                    res.orders,'orders,',
                    res.ordersByDate,'ordersByDate,',
                    res.categorySales,'categorySales,',
                    res.allProducts,'allProducts,',
                    res.allUsers,'allUsers,',
                    res.currentMonthSales,'currentMonthSales',)
        
        updateCards(res.currentMonthSales.totalAmount,res.orders.length,res.allProducts.length,res.allUsers.length)
        updateChart(0,res.orders)
      }
    })
  }; update();
</script>




</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:57 GMT -->
</html>